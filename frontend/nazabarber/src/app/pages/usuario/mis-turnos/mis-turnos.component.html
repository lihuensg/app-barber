<div class="turnos-overlay">
  <h2>Mis Turnos</h2>

  <!-- Toasts -->
  <div *ngIf="mensajeExito" class="toast toast-exito">{{ mensajeExito }}</div>
  <div *ngIf="mensajeError" class="toast toast-error">{{ mensajeError }}</div>

  <!-- Turnos Futuros -->
  <div class="seccion-historial">
    <h3>ðŸ•“ Turnos Futuros</h3>
    <ng-container *ngIf="diasFuturos.length; else sinFuturos">
      <div *ngFor="let dia of diasFuturos" class="dia-turno">
        <div class="dia-header" (click)="dia.expandido = !dia.expandido">
          <h4>{{ dia.nombre }} ({{ dia.fechaFormateada }})</h4>
          <span class="flecha" [class.abierto]="dia.expandido">â–¼</span>
        </div>

        <div class="turnos-lista" [class.expandido]="dia.expandido">
          <div class="row">
            <div
              class="col-turno"
              *ngFor="let turno of turnosPorDiaFuturos[dia.fecha]"
            >
              <div class="turno-card">
                <p><strong>{{ turno.hora }}</strong></p>
                <button
                  class="cancelar-btn"
                  (click)="solicitarCancelarTurno(turno)"
                >
                  Cancelar
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
    <ng-template #sinFuturos>
      <p>No tenÃ©s turnos futuros.</p>
    </ng-template>
  </div>

  <!-- Turnos Pasados -->
  <div class="seccion-historial">
    <h3>ðŸ“œ Turnos Pasados</h3>
    <ng-container *ngIf="diasPasados.length; else sinPasados">
      <div *ngFor="let dia of diasPasados" class="dia-turno">
        <div class="dia-header" (click)="dia.expandido = !dia.expandido">
          <h4>{{ dia.nombre }} ({{ dia.fechaFormateada }})</h4>
          <span class="flecha" [class.abierto]="dia.expandido">â–¼</span>
        </div>

        <div class="turnos-lista" [class.expandido]="dia.expandido">
          <div class="row">
            <div
              class="col-turno"
              *ngFor="let turno of turnosPorDiaPasados[dia.fecha]"
            >
              <div class="turno-card">
                <p><strong>{{ turno.hora }}</strong></p>
                <p class="estado-pasado">Cortado</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
    <ng-template #sinPasados>
      <p>No tenÃ©s turnos pasados.</p>
    </ng-template>
  </div>
</div>

<!-- Modal ConfirmaciÃ³n Cancelar -->
<div *ngIf="mostrarModalCancelar" class="modal-overlay">
  <div class="modal-contenido">
    <h2>Â¿Cancelar turno?</h2>
    <p>Esta acciÃ³n no se puede deshacer.</p>
    <div class="modal-botones">
      <button (click)="confirmarCancelacion()" class="btn btn-danger">
        Cancelar turno
      </button>
      <button (click)="cancelarModal()" class="btn btn-cancelar">
        Volver
      </button>
    </div>
  </div>
</div>
